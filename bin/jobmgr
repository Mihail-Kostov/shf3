#!/bin/bash
source $(dirname ${BASH_SOURCE})/../lib/header
import que
import gui

function help/jobmgr() {
  cat << EOF

Job Submitter

Usage: ${gbn} options
              -b jobfile  - submitt
              -l jobfile  - login
              -d database - job track
              -n - no check
              -v - verbose
EOF
  exit ${_false_}
}

### args
_j="batch.job"
_c="LIST"
_d=""
_x=""
_q="batch:1:8"
_f=true
_v=false
while getopts hvnb:l:d:q:x: o; do
  case "$o" in
    b) _c="BATCH"; _j=$OPTARG;;
    l) _c="LOGIN"; _j=$OPTARG;;
    d) _d=$OPTARG;;
    q) _q=$OPTARG;;
    x) _x=$OPTARG;;
    f) _f=false;;
    v) gdbg=true;;
    h|*) help/jobmgr;;
  esac
done

### main
case "${_c}" in
  BATCH)
    _msg="Batch"
    ;;
  LOGIN)
    _msg="Login"
    ;;
  LIST)
    _msg="Job Track"
    ;;
  EXEC)
    _msg="Execute"
    que/exec "${_q}" "${_x}"
    exit $?
    ;;
esac

echo
msg "${_msg}"
gui/line

# track database
import que/track
que_track_db="${grd}/sql/${que_track_db}"

# override
if ! test -z "${_d}" ; then
  que_track_db="${_d}"
fi

que/sub "${_c}" "${_j}" ${_f}
