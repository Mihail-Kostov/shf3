#!/bin/bash
source $(dirname ${BASH_SOURCE})/../../lib/header
import net/ipfw

function shield/start() {
  echo "Starting Firewall"

  import net/ipfw
  import net/ipfw/spoof

  # flush
  net/ipfw/reset

}

function shield/stop() {
  net/ipfw/reset
}

function shield/restart() {
  shield/stop
  sleep 1
  shiled/start
}

net_ipfw_db="${grd}/sql/${net_ipfw_db}"

if ! readable "${net_ipfw_db}" ; then
  net/ipfw/init
fi

### main
action="${1:-start}"
case "${action}" in
  start|stop|restart)
    shield/${action}
  ;;
esac
