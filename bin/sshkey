#!/bin/bash
source $(dirname ${BASH_SOURCE})/../lib/header
import gui
import ssh/key

function sshkey/help() {
  cat << EOF

SSH key generator

Usage: ${gbn} options
              -n MID - new
              -c MID - change
              -v - verbose
EOF
  exit ${_false_}
}

### args
_m=""
_c="NEW"
while getopts hvc:n: o; do
  case "$o" in
    n) _n="NEW"; _m=$OPTARG;;
    c) _c="CHANGE"; _m=$OPTARG;;
    v) gdbg=true;;
    h) sshkey/help;;
    *) sshkey/help;;
  esac
done

### main
echo
msg
gui/line

if test "${_m}" = "" ; then
  echo -n "[${gbn}] Enter MID: "
  read _m
fi

case ${_c} in
  CHANGE)
    answer "Change key for ${_m}?"
    if test $? -gt 0 ; then
      exit ${_false_}
    fi
    ssh/key/chg "${_m}"
    ;;
  NEW)
    answer "Generate key for ${_m}?"
    if test $? -gt 0 ; then
      exit ${_false_}
    fi
    ssh/key/gen "${_m}"
    ;;
esac
